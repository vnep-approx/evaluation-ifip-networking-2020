#!/usr/bin/env bash

help=$'Plots all implemented figures of a given reduced results pickle file, generated by an experiment of the Topology Zoo.
The ALIB_EXPERIMENT_HOME environment variable needs to be set.

Usage: ./plot_all_zoo_from_vm.sh <<folder_name>> <<reduced_results_pickle>>'

folder_name=$1
reduced_results_pickle=$2

if [[ "$@" == *'-h'* ]] || [[ "$@" == *'--help' ]]; then
    echo "${help}";
    exit 0;
fi;

pickle_file="$(basename ${reduced_results_pickle})"
cp ${reduced_results_pickle} ${ALIB_EXPERIMENT_HOME}/input/${pickle_file}
mkdir -p ${folder_name}

for p in total_runtime best_fractional_cost best_integer_cost max_edge_load \
          max_node_load preprocess_runtime optimization_runtime postprocess_runtime relative_cost;
do
    python -m evaluation_ifip_networking_2020.cli make_box_plot ${pickle_file} "request_generation/fog_app/SyntheticSeriesParallelDecomposableRequestGenerator/pseudo_random_seed"\
     "substrate_generation/substrates/TopologyZooReader/topology" $p --output_plot_file_name \
     "Substrate_size-to-$p" --output_path `pwd`/${folder_name} --axis_tick_rarity 1 --output_filetype png ;
    for file in ${ALIB_EXPERIMENT_HOME}/log/*; 	do mv $file ${folder_name} ; done
done


